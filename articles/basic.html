<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic: Module Building • rOpenSci: outsider.devtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- ropensci --><link href="../ropensci.css" rel="stylesheet">
<meta property="og:title" content="Basic: Module Building">
<meta property="og:description" content="outsider.devtools">
<meta name="twitter:card" content="summary">
<!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a href="https://ropensci.org"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
        <a class="navbar-brand" href="../index.html"><i>outsider.devtools <small>v0.1.0</small></i></a>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Module Building
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic.html">Basic</a>
    </li>
    <li>
      <a href="../articles/intermediate.html">Intermediate</a>
    </li>
    <li>
      <a href="../articles/advanced.html">Advanced</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/faqs.html">FAQs</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/ropensci/outsider.devtools">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right docsearch" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic: Module Building</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/outsider.devtools/blob/master/vignettes/basic.Rmd"><code>vignettes/basic.Rmd</code></a></small>
      <div class="hidden name"><code>basic.Rmd</code></div>

    </div>

    
    
<p><code>outsider</code> allows users to install and run programs on their own computer without the need to leave the R environment. If there is a command-line program that is not available through <code>outsider</code> you can create your own module!</p>
<p>If you are able to install the program on your own machine and have some experience with R packages and GitHub then you should be readily able to create one.</p>
<p>On this page, we will outline what an <code>outsider</code> module is and then provide a simple walkthrough for creating the simplest of simple modules: a command line program that prints whatever text the user provides it.</p>
<p>To follow this guide you will need the following:</p>
<ul>
<li>A GitHub account (sign-up <a href="https://github.com/">here</a>)</li>
<li>A Docker-Hub account (sign-up <a href="https://hub.docker.com/">here</a>)</li>
</ul>
<hr>
<div id="basics" class="section level1">
<h1 class="hasAnchor">
<a href="#basics" class="anchor"></a>Basics</h1>
<div id="module-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#module-structure" class="anchor"></a>Module structure</h2>
<p>At its heart, an <code>outsider</code> module is just an R package with a <code>Dockerfile</code>. All modules have the following basic file/folder structure:</p>
<pre><code># Core files and folders of a module #
- DESCRIPTION
- R/
    - functions.R
    - import.R
- inst/
    - dockerfiles/
        - latest/
            - Dockerfile
    - om.yaml
- README.md
- README.Rmd
- .travis.yml</code></pre>
<div id="r-files-and-folders" class="section level3">
<h3 class="hasAnchor">
<a href="#r-files-and-folders" class="anchor"></a>R files and folders</h3>
<p>The R package is determined by the <code>DESCRIPTION</code> file and the <code>R/</code> folder. The first of these describes the package details (package name, author, dependencies, etc.) and the second contains the R code that makes up the package. The <code>R/</code> folder can have any number of scripts with whatever names a developer chooses (skeleton default <code>functions.R</code> and <code>import.R</code>).</p>
</div>
<div id="docker-files-and-folders" class="section level3">
<h3 class="hasAnchor">
<a href="#docker-files-and-folders" class="anchor"></a>Docker files and folders</h3>
<p>The <code>outsider</code> package and its modules depend on Docker to run. Docker is a service that is able to host isolated software packages, termed “containers”, that act <em>like</em> virtual machines but, thanks to <a href="https://en.wikipedia.org/wiki/OS-level_virtualization">OS-level virtualisation</a>, are in fact much more lightweight. By using a Docker container a user is able to run specific code, often designed for different operating systems, on any machine that has Docker installed. A Docker container is created by running a Docker “image” where the image acts as a description of the code necessary for the container to function (base operating system, required programs, etc.). And these images are described by a <code>Dockerfile</code>.</p>
<table class="table">
<colgroup>
<col width="45%">
<col width="55%">
</colgroup>
<thead><tr class="header">
<th>Docker term</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Container</td>
<td align="left">Isolated environment where applications are hosted and launched</td>
</tr>
<tr class="even">
<td>Image</td>
<td align="left">A file that acts as the “blueprint” for containers</td>
</tr>
<tr class="odd">
<td>Dockerfile</td>
<td align="left">Text-based file describing the steps (layers) that define an image</td>
</tr>
</tbody>
</table>
<p>In an <code>outsider</code> module, the <code>dockerfiles/</code> folder in the module contains the <code>Dockerfile</code> that describes how to install the external command-line program that the developer wishes to run through R. <code>dockerfiles/</code> can have multiple versions of a <code>Dockerfile</code> but every module must have a <code>latest/</code>.</p>
<blockquote>
<p><strong>Why “latest”?</strong> Every Docker image is tagged with a version name/number. For <code>outsider</code> modules all images must have a “latest” tag which acts as the default tag. Additionally, a developer may add any number of additional tagged versions of their program (e.g.legacy version of a program) to their module by creating new Dockerfiles in separate directories under <code>dockerfiles/</code>.</p>
</blockquote>
<p>For more information on Docker, see:</p>
<ul>
<li><a href="https://docs.docker.com/">Official Docker Docs</a></li>
<li><a href="https://docs.docker.com/glossary/">Docker glossary</a></li>
<li><a href="https://docker-curriculum.com/">Learn Docker Basics</a></li>
<li><a href="https://en.wikipedia.org/wiki/Docker_(software)">Wikipedia Page</a></li>
</ul>
</div>
<div id="github-files-and-folders" class="section level3">
<h3 class="hasAnchor">
<a href="#github-files-and-folders" class="anchor"></a>GitHub files and folders</h3>
<p>To make modules discoverable on GitHub, all modules require an <code>om.yml</code>. This file has two elements (program and details) encoded in the <a href="https://en.wikipedia.org/wiki/YAML">YAML format</a>. In addition, the module has a <code>README.md</code> file that provides the text describing the module on the module’s GitHub (or other code-sharing site) homepage. <code>.md</code> format is like a simplified HTML. It can be generated by hand or – by default with <code>outsider.devtools</code> – it can be rendered from a <code>.Rmd</code> file, in this case <code>README.Rmd</code>. The advantage of the <code>.Rmd</code>-approach is that R code chunks are parsed and their output is then included in the <code>.md</code> version of the file. This allows users to better understand the code as they can directly see the output.</p>
<p>Finally, a <code>.travis.yml</code> provides instructions detailing how the module should be tested on <a href="https://en.wikipedia.org/wiki/Travis_CI">Travis-CI</a>. By default, the <code>outsider.devtools</code> helper functions create a <code>.travis.yml</code> file that tests by installing the module and then running the examples of the exported R functions.</p>
<hr>
</div>
</div>
</div>
<div id="walkthrough" class="section level1">
<h1 class="hasAnchor">
<a href="#walkthrough" class="anchor"></a>Walkthrough</h1>
<p>We will walk you through how to create your own <code>outsider</code> module that will simply print (through <code>echo</code>) any text provided. This process comes in a series of steps:</p>
<ol style="list-style-type: lower-roman">
<li>Generate core files and folders</li>
<li>Create Docker image</li>
<li>Document and build the R package</li>
<li>Try the module</li>
<li>Upload to GitHub and Docker Hub</li>
</ol>
<blockquote>
<p><strong>What’s “Docker Hub”?</strong> Docker Hub is service that hosts Docker images. It can simplify Dockerfile creation as image layers can be sourced from pre-existing images available via Docker Hub. Additionally, by sharing your images generated from your module Dockerfile on Docker Hub, you will be speeding up the installation step for end-users.</p>
</blockquote>
<div id="generate-the-files-and-folders" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-the-files-and-folders" class="anchor"></a>Generate the files and folders</h2>
<p>As displayed above, we need to generate the core files and folders of a module. This process can be easily performed using the <code><a href="../reference/module_skeleton.html">module_skeleton()</a></code> function. This function takes a few details about the developer and the program and then generates all the necessary core file structures.</p>
<p>The necessary information required for the module to run are our GitHub and Docker Hub usernames plus the name for the program we wish to provide as a module (which is <code>echo</code> – a UNIX command for printing). In these code snippets, the usernames are of the <code>outsider</code> maintainer. In order for these examples to work for you, you will need to change “dombennett” to your own usernames. (Note, your usernames may differ for GitHub and Docker Hub).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/outsider.devtools">outsider.devtools</a></span><span class="op">)</span>
<span class="co"># the file location of where the module is saved is returned to "module_path"</span>
<span class="va">module_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/module_skeleton.html">module_skeleton</a></span><span class="op">(</span>repo_user <span class="op">=</span> <span class="st">'dombennett'</span>, program_name <span class="op">=</span> <span class="st">'echo'</span>,
                               docker_user <span class="op">=</span> <span class="st">'dombennett'</span>, flpth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>,
                               full_name <span class="op">=</span> <span class="st">'D.J. Bennett'</span>,
                               email <span class="op">=</span> <span class="st">'dominic.john.bennett@gmail.com'</span>,
                               service <span class="op">=</span> <span class="st">'github'</span><span class="op">)</span>
<span class="co"># folder name where module is stored</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html">basename</a></span><span class="op">(</span><span class="va">module_path</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "om..echo"</code></pre>
<p>The above code will create an <code>outsider</code> module with the module and directory name <code>om..echo</code> at the file location <code>module_path</code>. After running the above code, you should take a minute to inspect the generated files. In particular you should look at the <code>DESCRIPTION</code> file, the <code>Dockerfile</code> and <code>functions.R</code>.</p>
<p><strong>File tree <code>module_path</code> (before build)</strong></p>
<pre><code>## ├── DESCRIPTION
## ├── R
## │   ├── functions.R
## │   └── import.R
## ├── README.Rmd
## ├── examples
## │   └── example.R
## └── inst
##     ├── dockerfiles
##     │   └── latest
##     │       └── Dockerfile
##     └── om.yml</code></pre>
<blockquote>
<p><strong>Why <code>om..echo</code>?</strong> All modules must start with “om..” in order for them to be discovered on GitHub. This is not a requirement for the functioning of the module, it just allows <code><a href="https://docs.ropensci.org/outsider/reference/module_search.html">outsider::module_search()</a></code> to find them.</p>
</blockquote>
<p>At this stage, we would then edit the <code>inst/dockerfiles/latest/Dockerfile</code> and the <code>R/functions.R</code> to work for our chosen external program. But because <code>echo</code> – the program we wish to port through <code>outsider</code> – is so simple we don’t actually have to make any changes to these files. By default, the <code>Dockerfile</code> is based on Ubuntu which ships with <code>echo</code> and our starting function in <code>functions.R</code> is based around running <code>echo</code>: it parses the arguments, creates an outsider object, and then launches the object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The echo function in om..echo</span>
<span class="va">echo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># convert the ... into an argument list</span>
  <span class="va">arglist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/outsider.base/reference/arglist_get.html">arglist_get</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
  <span class="co"># create an outsider object: describe the arguments and program</span>
  <span class="va">otsdr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/outsider.base/reference/outsider-class.html">outsider_init</a></span><span class="op">(</span>pkgnm <span class="op">=</span> <span class="st">'om..echo'</span>,
                         cmd <span class="op">=</span> <span class="st">'echo'</span>, arglist <span class="op">=</span> <span class="va">arglist</span><span class="op">)</span>
  <span class="co"># run the command</span>
  <span class="fu"><a href="https://docs.ropensci.org/outsider.base/reference/outsider-class.html">run</a></span><span class="op">(</span><span class="va">otsdr</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<blockquote>
<p><strong>What’s <code>...</code>?</strong> In function calls in R, <code>...</code> indicate that any number of arguments can be provided to a function. The <code>arglist_get</code> function will take the <code>...</code> and convert them into a character vector that can be parsed. <code>outsider</code> recommends module functions make use of this feature so that any number of arguments can be passed to external programs. Additionally, this has the advantage that the developer would then not need to document all the arguments of the external program. For many external programs there may be hundreds of arguments, all of which are likely to be already documented; viewable through commands like <code>-h</code> or <code>--help</code>. For programs with few arguments or where the execution of the external program requires additional setting-up (input files, environment settings, etc.) or where argument definitions cannot be displayed with <code>-h</code> or <code>--help</code> then it is best to provide richer documentation at the R level. In these instances, the specific arguments to the external program can either be separate R arguments, <code>function(arg1, arg2)</code>, or they can be a character vector along with other arguments, <code>function(arglist=arglist_get(...), input=NULL, memmory="1GB")</code>.</p>
</blockquote>
</div>
<div id="building-the-r-package" class="section level2">
<h2 class="hasAnchor">
<a href="#building-the-r-package" class="anchor"></a>Building the R package</h2>
<p>With the skeleton set-up, we can now install the R package using <code><a href="../reference/module_build.html">module_build()</a></code>. At this stage we only want to build the package components, not the Docker image, so we can set all build options to TRUE except for the <code>build_image</code> option.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/module_build.html">module_build</a></span><span class="op">(</span>flpth <span class="op">=</span> <span class="va">module_path</span>, build_documents <span class="op">=</span> <span class="cn">TRUE</span>, build_package <span class="op">=</span> <span class="cn">TRUE</span>,
             build_image <span class="op">=</span> <span class="cn">FALSE</span>, build_readme <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Updating om..echo documentation</code></pre>
<pre><code>## First time using roxygen2. Upgrading automatically...</code></pre>
<pre><code>## Updating roxygen version in /private/var/folders/x9/m8kwpxps2v93xk52zqzm5lkh0000gp/T/RtmpquGDgt/om..echo/DESCRIPTION</code></pre>
<pre><code>## Loading om..echo</code></pre>
<pre><code>## Building om..echo readme</code></pre>
<pre><code>## ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## Running devtools::document() ...
## ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## Writing NAMESPACE
## Writing NAMESPACE
## Writing echo.Rd
## ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## Running devtools::install() ...
## ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
##   
   checking for file ‘/private/var/folders/x9/m8kwpxps2v93xk52zqzm5lkh0000gp/T/RtmpquGDgt/om..echo/DESCRIPTION’ ...
  
✓  checking for file ‘/private/var/folders/x9/m8kwpxps2v93xk52zqzm5lkh0000gp/T/RtmpquGDgt/om..echo/DESCRIPTION’
## 
  
─  preparing ‘om..echo’:
## 
  
   checking DESCRIPTION meta-information ...
  
✓  checking DESCRIPTION meta-information
## 
  
─  checking for LF line-endings in source and make files and shell scripts
## 
  
─  checking for empty or unneeded directories
## 
  
─  building ‘om..echo_0.0.1.tar.gz’
## 
  
   
## 
Running /Library/Frameworks/R.framework/Resources/bin/R CMD INSTALL \
##   /var/folders/x9/m8kwpxps2v93xk52zqzm5lkh0000gp/T//RtmpquGDgt/om..echo_0.0.1.tar.gz --install-tests 
## 
-
* installing to library ‘/Library/Frameworks/R.framework/Versions/3.6/Resources/library’
## 
|
* installing *source* package ‘om..echo’ ...
## 
-
** using staged installation
## 
|
** R
## 
-
** inst
## 
|
** byte-compile and prepare package for lazy loading
## 
-

|
** help
## 
-
*** installing help indices
## 
|
** building package indices
## 
-
** testing if installed package can be loaded from temporary location
## 
|
** testing if installed package can be loaded from final location
## 
-
** testing if installed package keeps a record of temporary installation path
## 
|
* DONE (om..echo)
## 
-

|

 
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## Running devtools::build_readme() ...
## ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</code></pre>
<blockquote>
<p><strong>What does <code>build_documents = TRUE</code> do?</strong> In addition to the core files indicated above, an R package also requires R documentation files that are stored in <code>man/</code> – these provide the <code>?[function]</code> utility. The above function generates these files via <a href="https://github.com/klutometis/roxygen"><code>roxygen</code></a> comments and tags located in the R scripts that make up the package, i.e. all comments that begin <code>#'</code>. For more information, look up <a href="http://r-pkgs.had.co.nz/man.html">“object documentation in R”</a>.</p>
</blockquote>
<blockquote>
<p><strong>What does <code>build_readme = TRUE</code> do?</strong> This builds the <code>README.md</code> file from the <code>README.Rmd</code> file. The two files will contain the same text and images, but for any R code snippets in the <code>.Rmd</code>, these are first run and their output is captured and placed in the <code>.md</code> file. Remember that the <code>README.md</code> acts as the homepage to the module on GitHub.</p>
</blockquote>
<p><strong>File tree <code>module_path</code> (after build)</strong></p>
<pre><code>## ├── DESCRIPTION
## ├── NAMESPACE
## ├── R
## │   ├── functions.R
## │   └── import.R
## ├── README.Rmd
## ├── README.html
## ├── README.md
## ├── examples
## │   └── example.R
## ├── inst
## │   ├── dockerfiles
## │   │   └── latest
## │   │       └── Dockerfile
## │   └── om.yml
## └── man
##     └── echo.Rd</code></pre>
</div>
<div id="creatingbuilding-the-docker-image" class="section level2">
<h2 class="hasAnchor">
<a href="#creatingbuilding-the-docker-image" class="anchor"></a>Creating/Building the Docker image</h2>
<blockquote>
<p><strong>Dockerfile commands</strong> Dockerfiles are series of instructions for constructing a “containerised” machine called a Docker image (functionally it’s a bit like a virtual machine, but more lightweight). Each command begins with a capitalised instruction followed by arguments. The most common instruction would be “RUN”, this executes command-line code within the Docker image system. For example, <code>RUN echo "command!"</code> would pass “command!” to the program “echo”. All Dockerfiles begin with a FROM instruction, which pulls a Docker image on which to build your own image. For example, many images are built upon the Linux operating system Ubuntu in which case the first line of the Dockerfile would be “FROM ubuntu:latest”. This first line would then download the latest Ubuntu Docker image and all subsequent “RUN” instructions would be running in Ubuntu command-line. For far more detailed information on Dockerfiles, see the <a href="https://docs.docker.com/engine/docker-overview/">Docker docs</a>.</p>
</blockquote>
<p>In our <code>om..echo</code> we have a dockerfiles folder that contains a Dockerfile describing the Docker image for our <code>echo</code> program. Our “latest” Dockerfile contains the instructions to pull the Docker image of the latest Ubuntu release, to create a folder called “working_dir” and then set this new folder as the “WORKDIR”.</p>
<pre><code># Example host distro
FROM ubuntu:latest

# Install program using RUN lines

# outsider *requires* working_dir
RUN mkdir /working_dir
WORKDIR /working_dir</code></pre>
<blockquote>
<p><strong>What’s the WORKDIR?</strong> The WORKDIR sets the working directory when a command is passed to the Docker image. All <code>outsider</code> modules require this to be “working_dir” as it allows <code>outsider</code> functions to know where to transfer files to and from the container.</p>
</blockquote>
<p>Using the Dockerfile that was created with the skeleton, we can now build our Docker image using <code><a href="../reference/module_build.html">module_build()</a></code>. (In practice, we’d combine steps 2 and 3 by calling <code>module_build</code> and setting all the build arguments to TRUE.) Docker will build the image from the Dockerfile and store it along with all the other images that are available on your machine, you do not need to worry about where the Docker image is stored. With an existing image that is associated with the module, when the module’s code is called a new container is created from the image and commands are passed to the container from R.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/module_build.html">module_build</a></span><span class="op">(</span>flpth <span class="op">=</span> <span class="va">module_path</span>, tag <span class="op">=</span> <span class="st">'latest'</span>, build_image <span class="op">=</span> <span class="cn">TRUE</span>,
             build_documents <span class="op">=</span> <span class="cn">FALSE</span>, build_package <span class="op">=</span> <span class="cn">FALSE</span>,
             build_readme <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>## ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## Running docker_build()
## ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## Command:
## docker build -t dombennett/om_echo:latest /Library/Frameworks/R.framework/Versions/3.6/Resources/library/om..echo/dockerfiles/latest
## .....................................................................................................................</code></pre>
<blockquote>
<p><strong>What is a tag?</strong> A Docker tag is akin to the version number of the image. By default, if no tag is provided, Docker will use ‘latest’.</p>
</blockquote>
<blockquote>
<p><strong>Note</strong>: The functions try to be helpful by printing to screen the exact Docker commands of the tasks being performed. This is to give you a better idea of what is happening and to allow you to recreate the operations via a terminal.</p>
</blockquote>
</div>
<div id="try-the-module-" class="section level2">
<h2 class="hasAnchor">
<a href="#try-the-module-" class="anchor"></a>Try the module.</h2>
<p>With a Docker image and an installed R package we are now ready to try out the module before we upload it online. The below command will look up the associated image for module, create a new container, run the command and then shut-down the container. (If no associated image can be found, it will attempt to pull one from Docker Hub.)</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/outsider">outsider</a></span><span class="op">)</span></code></pre></div>
<pre><code>## ----------------
## outsider v 0.1.0
## ----------------
## - Security notice: be sure of which modules you install</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the repo always refers to the future github repo</span>
<span class="va">echo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/outsider/reference/module_import.html">module_import</a></span><span class="op">(</span><span class="st">'echo'</span>, repo <span class="op">=</span> <span class="st">'dombennett/om..echo'</span><span class="op">)</span>
<span class="fu">echo</span><span class="op">(</span><span class="st">'hello world!'</span><span class="op">)</span></code></pre></div>
</div>
<div id="upload-to-github-and-docker-hub" class="section level2">
<h2 class="hasAnchor">
<a href="#upload-to-github-and-docker-hub" class="anchor"></a>Upload to GitHub and Docker Hub</h2>
<p>After we have played with the module and ensured it works as we would hope, we can upload it to our GitHub and Docker accounts so that others may download it.</p>
<p>To upload to GitHub we must first create a version of the repository online. Visit your GitHub account and then create a new repository by clicking <code>Repositories &gt; New</code>. Ensure to name the online version with the same name as your module, i.e. <code>om..echo</code>. (No initial steps are required to upload to Docker-Hub.)</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># based on the module details, the function will determine which code-sharing</span>
<span class="co"># service to upload to</span>
<span class="fu"><a href="../reference/module_upload.html">module_upload</a></span><span class="op">(</span>flpth <span class="op">=</span> <span class="va">module_path</span>, code_sharing <span class="op">=</span> <span class="cn">TRUE</span>, dockerhub <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<hr>
<p><strong>Delete it all</strong></p>
<p>Don’t want <code>om..echo</code> on your computer? Delete it so …</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># to delete the Docker image and uninstall the R package</span>
<span class="fu"><a href="https://docs.ropensci.org/outsider/reference/module_uninstall.html">module_uninstall</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">'dombennett/om..echo'</span><span class="op">)</span></code></pre></div>
<pre><code>## Removing 'om..echo'</code></pre>
<pre><code>## Removing package from '/Library/Frameworks/R.framework/Versions/3.6/Resources/library'
## (as 'lib' is unspecified)</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># to delete the repo folder</span>
<span class="fu"><a href="https://rdrr.io/r/base/unlink.html">unlink</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">module_path</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<hr>
</div>
<div id="next-up-intermediate" class="section level2">
<h2 class="hasAnchor">
<a href="#next-up-intermediate" class="anchor"></a>Next-up: <a href="https://docs.ropensci.org/outsider.devtools/articles/intermediate.html">Intermediate</a>
</h2>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start bottom-8">
            <div class="col-xs-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-xs-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="http://github.com/ropensci" target="_blank"><div class="icon fab fa-github"></div></a>
                        <a href="http://github.com/ropenscilabs" target="_blank"><div class="icon fa fa-flask"></div></a>
                        <a href="http://twitter.com/ropensci" target="_blank"><div class="icon fab fa-twitter"></div></a>
                        <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review">Software Review Process</a></li>
                            <li><a href="https://ropensci.org/about#team">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate">Donate</a></li>
                            <li><a href="https://ropensci.org/contact">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/">Documentation</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                        <a href="http://numfocus.org" target="_blank"></a>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '799829e946e1f0f9cd5b5a782c6316b9',
    indexName: 'ropensci-outsider.devtools',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
